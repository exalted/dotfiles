# ------------------------------------------------------------------------------
# Ref.: http://stackoverflow.com/a/11335979/11895
# ------------------------------------------------------------------------------
homebrew=/usr/local/bin:/usr/local/sbin
export PATH=$homebrew:$PATH
unset homebrew

# ------------------------------------------------------------------------------
# Executable python scripts will be put in:
#   /usr/local/share/python
# so you may want to put "/usr/local/share/python" in your PATH, too.
# ------------------------------------------------------------------------------
export PATH=/usr/local/share/python:$PATH

# ------------------------------------------------------------------------------
# Homebrew recommends prepending the following path to your PATH environment
# variable to have npm-installed binaries picked up:
#   /usr/local/share/npm/bin
# ------------------------------------------------------------------------------
export PATH=/usr/local/share/npm/bin:$PATH

# ------------------------------------------------------------------------------
# See "brew info bash-completion"
# ------------------------------------------------------------------------------
if [ -f $(brew --prefix)/etc/bash_completion ]; then
    . $(brew --prefix)/etc/bash_completion
fi

# ------------------------------------------------------------------------------
# Add the /bin directory that ships with Postgres.app
# Ref.: http://postgresapp.com/documentation
# ------------------------------------------------------------------------------
export PATH=/Applications/Postgres.app/Contents/MacOS/bin:$PATH

# ------------------------------------------------------------------------------
# Pimp my prompt
# ------------------------------------------------------------------------------
function __ps1_newline_login {
    if [[ -n "${PS1_NEWLINE_LOGIN:-}" ]]; then
        echo
    else
        PS1_NEWLINE_LOGIN=true
    fi
}

PROMPT_COMMAND="${PROMPT_COMMAND}__ps1_newline_login;"

export GIT_PS1_SHOWDIRTYSTATE=true `# show unstaged (*) and staged (+) changes`

# export PS1="\h:\W \u\$ "
export PS1="\[\e[32m\]\$(__git_ps1 \"%s \")\[\e[31m\]➜\[\e[0m\]  "

# ------------------------------------------------------------------------------
# Ref.: http://noiseandheat.com/blog/2011/12/os-x-lion-terminal-colours/
# ------------------------------------------------------------------------------
#
# Tell ls to be colourful
export CLICOLOR=1
#
# Tell grep to highlight matches
export GREP_OPTIONS='--color=auto'
#
source "`brew --prefix`/etc/grc.bashrc"

# ------------------------------------------------------------------------------
# More less ;-)
# ------------------------------------------------------------------------------

alias less='less --RAW-CONTROL-CHARS --IGNORE-CASE'

# ------------------------------------------------------------------------------
# virtualenv
# ------------------------------------------------------------------------------
# startup virtualenv-burrito
if [ -f $HOME/.venvburrito/startup.sh ]; then
    . $HOME/.venvburrito/startup.sh
fi

# ------------------------------------------------------------------------------
# rbenv
# ------------------------------------------------------------------------------
if which rbenv > /dev/null; then
    # Enable shims and autocompletion
    eval "$(rbenv init -)";

    # Adding project-specific binstubs to PATH
    # (Ref.: https://github.com/sstephenson/rbenv/wiki/Understanding-binstubs)
    export PATH="./bin:$PATH"
fi

# Workaround: revert side effect of adding './bin' to your PATH above using
# rbenv's "ri" instead of Bundler binstub's
function ri {
    eval "$(rbenv which ri)" "$@"
}

# Workaround: apparently "gem rdoc --all" can't generate documentation for
# pseudo gems like bigdecimal, io-console, psych and the others that are bundled
# with Ruby that are not placed in the directories RubyGems is expecting but
# instead they are in stdlib path.
# (Ref.: https://github.com/rubygems/rubygems/issues/79)
function gem-gendocs {
    if [[ "$@" == *--all* ]]; then
        echo "Watch out! I accept same options as \"gem rdoc\" except '--all'." >&2
        return 1
    fi
    local env_version="$(rbenv version | cut -d" " -f1)"
    # just in case you have write permissions to system path (which usually you
    # don't and that's okay):
    if [[ "$env_version" == "system" ]]; then
        echo "Trying to generate documentation for system, \
switch to an environment instead?" >&2
        return 1
    fi
    echo "Generating documentation for $env_version..."
    for gemname in $(gem list | cut -d" " -f1); do
        gem rdoc "$@" "$gemname" 2> /dev/null
    done
    echo "Done."
}

# ------------------------------------------------------------------------------
# EDITOR
# ------------------------------------------------------------------------------
export EDITOR='subl'

# ------------------------------------------------------------------------------
# Default Development Directory
# ------------------------------------------------------------------------------
export DEVELOPMENT_DIR=$HOME/Development

# ------------------------------------------------------------------------------
# Ref.: http://superuser.com/a/95655/45837
# ------------------------------------------------------------------------------
__expand_tilde_by_ref(){ true; }
_expand(){ true; }

# ------------------------------------------------------------------------------
# Common typos
# ------------------------------------------------------------------------------
alias cd..="cd .."

# ------------------------------------------------------------------------------
# Ref.: https://github.com/defunkt/hub#aliasing
# ------------------------------------------------------------------------------
eval "$(hub alias -s)"

# ------------------------------------------------------------------------------
# Ref.: https://github.com/jkbr/httpie#redirected-output
# ------------------------------------------------------------------------------
function httpless {
    http --pretty=all "$@" | less --RAW-CONTROL-CHARS --IGNORE-CASE;
}

# ------------------------------------------------------------------------------
# Ref.: https://github.com/jkbr/httpie#redirected-output
# ------------------------------------------------------------------------------
alias kionpw='pwgen -cnyB 10 1'

# ------------------------------------------------------------------------------
# Fake commands
# ------------------------------------------------------------------------------
alias spider='wget --force-directories --recursive --no-clobber --convert-links --no-parent'

alias diskusage='du -sh'

function google {
    local search=""
    for term in "$@"; do
        if [[ -z "${search:-}" ]]; then
            search="$term"
        else
            search="$search%20$term"
        fi
    done
    if [[ -z "${search:-}" ]]; then
        echo "Usage: google something" >&2
        return 1
    else
        open "http://www.google.com/?q=$search";
    fi
}
alias search=google

alias facebook="open http://www.facebook.com/"
alias fb=facebook
